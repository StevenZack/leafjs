<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="leaf.js"></script>
    <link rel="stylesheet" href="app.css">
</head>

<body>
    <ul id="for3-id">
        <input type="text" placeholder="title" l-value="title" onkeyup="appFor3.title.postValue(this.value)">
        <input type="text" placeholder="name" l-value="name" onkeyup="appFor3.name.postValue(this.value)">
        <button onclick="doAdd()">Add</button>
        <li l-for="list as v,i">
            <span>
                {{v.title}}
            </span>
            <a href="#" l-onclick="'doRemoveItem('+i+')'">delete</a>
            <div>
                <span  l-for="items as v2,j">
                    <button l-onclick="'doAddItem('+i+','+j+')'">{{v2.name}}</button>
                </span>
            </div>
        </li>
    </ul>
    <script>
        window.doRemoveItem = function (i) {
            appFor3.list.removeAt(i)
        }
        window.doAddItem = function (i, j) {
            appFor3.list.value[i].items.append({
                name: 'Item ' + j,
            })
        }
        window.doAdd = function () {
            var title = appFor3.title.value;
            var name = appFor3.name.value;
            if (!title || !name) {
                return;
            }
            appFor3.list.append({
                title: title,
                items: Observable([
                    {
                        name: name,
                    }
                ])
            })
        }
        appFor3 = Leaf('for3-id', {
            title: Observable(''),
            name: Observable(''),
    
            list: Observable([
                {
                    title: 'One',
                    items: Observable([
                        {
                            name: 'Bob'
                        }
                    ])
                },
                {
                    title: 'Two',
                    items: Observable([
                        {
                            name: 'asd'
                        }
                    ])
                },
                {
                    title: 'Three',
                    items: Observable([
                        {
                            name: 'ppp'
                        }
                    ])
                },
            ])
        })
    </script>
</body>

</html>